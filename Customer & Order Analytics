-- In the following queries, I'm utilizing a database with multiple tables to quantify statistics regarding customer and order data. 


-- Shows how many customers ordered more than two products at a time in February, and what the average amount spent for those customers was.
SELECT Count(DISTINCT Cust.acctnum)             AS cust_count, 
       Round(Avg(quantity * price), 2) AS avg_amt_spent 
FROM   bit_db.febsales Feb 
       JOIN bit_db.customers Cust 
         ON FEB.orderid = Cust.order_id 
WHERE  Feb.quantity > 2 
       AND Length(orderid) = 6 
       AND orderid <> 'Order ID'; 

-- Cleans order_id column and shows how many orders were placed in January.
SELECT Count(orderid) 
FROM   bit_db.jansales 
WHERE  Length(orderid) = 6 
       AND orderid <> 'Order ID'; 

-- Builds on the previous query and shows how many of those orders were for iPhone(s).
SELECT Count(orderid) AS count_iphones 
FROM   bit_db.jansales 
WHERE  product = 'iPhone' 
       AND Length(orderid) = 6 
       AND orderid <> 'Order ID'; 

-- Selects the customer account numbers for all the orders that were placed in February.
SELECT DISTINCT acctnum 
FROM   bit_db.customers cust 
       JOIN bit_db.febsales feb 
         ON cust.order_id = feb.orderid 
WHERE  Length(orderid) = 6 
       AND orderid <> 'Order ID'; 

-- Shows the total revenue for each product sold in January.
SELECT product, 
       Round(( Sum(quantity) * price ), 2) AS revenue 
FROM   bit_db.jansales 
WHERE  Length(orderid) = 6 
       AND orderid <> 'Order ID' 
GROUP  BY product; 
